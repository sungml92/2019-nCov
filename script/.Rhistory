library(ggplot2)
library(dplyr)
library(ggtree)
library(treeio)
library(treedater)
library(lubridate)
folder = "../../"
tempfile = "tree/2019nCoV_013120_tempest_data.txt"
df <- read.csv(paste(folder,dfile,sep=''),sep='\t',na.strings = "")
df <- read.csv(paste(folder,tempfile,sep=''),sep='\t',na.strings = "")
df %>%
geom_point()
df %>%
geom_point(aes(x=date,y=distance))
df %>%
geom_point(aes(x=date,y=distance))
df %>%
ggplot()+
geom_point(aes(x=date,y=distance))
df %>%
ggplot()+
geom_point(aes(x=date,y=distance)) +
geom_smooth(method = "lm")
df %>%
ggplot(aes(x=date,y=distance))+
geom_point() +
geom_smooth(method = "lm")
df %>%
ggplot(aes(x=date,y=distance))+
geom_point() +
geom_smooth(method = "lm", se = FALSE)
df %>%
ggplot(aes(x=date,y=distance))+
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
xlim(19,20.1)
df %>%
ggplot(aes(x=date,y=distance))+
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
xlim(19.5,20.1)
lm_fit <- lm(date~distance,data=df)
df %>%
ggplot(aes(x=date,y=distance))+
geom_point() +
#geom_smooth(method = "lm", se = FALSE) +
geom_line(data = fortify(lm_fit), aes(x = date, y = .fitted)) +
xlim(19.5,20.1)
lm_fit <- lm(disp~date,data=df)
df %>%
ggplot(aes(x=date,y=distance))+
geom_point() +
#geom_smooth(method = "lm", se = FALSE) +
geom_line(data = fortify(lm_fit), aes(x = date, y = .fitted)) +
xlim(19.5,20.1)
df %>%
ggplot(aes(x=date,y=distance))+
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
#geom_line(data = fortify(lm_fit), aes(x = date, y = .fitted)) +
xlim(19.7,20.1)
lm_fit <- lm(date~distance,data=df)
plot(date ~ distance, data = df)
abline(lm_fit)
lm_fit <- lm(distance~date,data=df)
plot(distance ~ date, data = df)
abline(lm_fit)
df %>%
ggplot(aes(x=date,y=distance))+
geom_point() +
#geom_smooth(method = "lm", se = FALSE) +
abline(lm_fit)
df %>%
ggplot(aes(x=date,y=distance))+
geom_point() +
#geom_smooth(method = "lm", se = FALSE) +
abline(lm_fit) +
#geom_line(data = fortify(lm_fit), aes(x = date, y = .fitted)) +
xlim(19.7,20.1)
df %>%
ggplot(aes(x=date,y=distance))+
geom_point() +
#geom_smooth(method = "lm", se = FALSE) +
abline(lm_fit) +
stat_smooth(method = "lm", col = "red") +
#geom_line(data = fortify(lm_fit), aes(x = date, y = .fitted)) +
xlim(19.7,20.1)
ggplotRegression <- function (fit) {
require(ggplot2)
ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) +
geom_point() +
stat_smooth(method = "lm", col = "red") +
labs(title = paste("Adj R2 = ",signif(summary(fit)$adj.r.squared, 5),
"Intercept =",signif(fit$coef[[1]],5 ),
" Slope =",signif(fit$coef[[2]], 5),
" P =",signif(summary(fit)$coef[2,4], 5)))
}
ggplotRegression(lm(distance ~ date, data = df))
df %>%
ggplot(aes(x=date,y=distance))+
geom_point() +
#geom_smooth(method = "lm", se = FALSE) +
#geom_line(data = fortify(lm_fit), aes(x = date, y = .fitted)) +
xlim(19.7,20.1)
abline(lm_fit)
df %>%
ggplot(aes(x=date,y=distance))+
geom_point() +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE) +
xlim(19.7,20.1)
df %>%
ggplot(aes(x=date,y=distance))+
geom_point() +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE)
df %>%
ggplot(aes(x=date,y=distance))+
geom_point() +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE) +
xlim(19.5,20.01)
df %>%
ggplot(aes(x=date,y=distance))+
geom_point() +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE) +
xlim(19.7,20.01)
df %>%
ggplot(aes(x=date,y=distance))+
geom_point() +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE) +
xlim(19.7,20.1)
df %>%
ggplot(aes(x=date,y=distance))+
geom_point() +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="black") +
xlim(19.7,20.1)
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="black") +
xlim(19.7,20.1)
tempfile = "tree/2019nCoV_013120_tempest_data.txt"
folder = "../../"
tempfile = "tree/2019nCoV_013120_tempest_data.txt"
df <- read.csv(paste(folder,tempfile,sep=''),sep='\t',na.strings = "")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="black") +
xlim(19.7,20.1)
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="black",size=0.5) +
xlim(19.7,20.1)
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="black",size=0.5) +
xlim(19.7,20.1) +
legend(FALSE)
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="black",size=0.5) +
xlim(19.7,20.1) +
theme(legend=FALSE)
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="black",size=0.5) +
xlim(19.7,20.1) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
theme_minimal()+
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="black",size=0.5) +
xlim(19.7,20.1) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
theme_tufte()+
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="black",size=0.5) +
xlim(19.7,20.1) +
theme(legend.position = "none")
install.packages("ggthemes")
library(ggthemes)
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
theme_tufte()+
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="black",size=0.5) +
xlim(19.7,20.1) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
theme_tufte()+
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="black",size=0.5) +
geom_rangeframe() +
xlim(19.7,20.1) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
theme_tufte()+
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="black",size=0.5) +
geom_rangeframe() +
scale_x_continuous(19.7,20.1) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
theme_tufte()+
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="black",size=0.5) +
geom_rangeframe() +
scale_x_continuous(limits =c(19.7,20.1)) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
theme_tufte()+
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="black",size=0.5) +
#geom_rangeframe() +
scale_x_continuous(limits =c(19.7,20.1)) +
#theme(legend.position = "none")
theme_stata() + scale_color_stata()
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
theme_tufte()+
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="black",size=0.5) +
#geom_rangeframe() +
scale_x_continuous(limits =c(19.7,20.1)) +
theme(legend.position = "none") +
theme_calc()+ scale_colour_calc()
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
theme_tufte()+
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="black",size=0.5) +
geom_rangeframe() +
scale_x_continuous(limits =c(19.7,20.2)) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
#theme_tufte()+
theme_hc()+ scale_colour_hc() +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="black",size=0.5) +
#geom_rangeframe() +
scale_x_continuous(limits =c(19.7,20.2)) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
theme_tufte()+
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="black",size=0.5) +
geom_rangeframe() +
scale_x_continuous(limits =c(19.7,20.2)) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
theme_tufte()+
stat_smooth(geom='line', alpha=0.5, se=FALSE) +
#geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="red",size=0.2) +
geom_rangeframe() +
scale_x_continuous(limits =c(19.7,20.2)) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
geom_line(stat="smooth",metho="lm",size=0.5,alpha=0.5)
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
geom_line(stat="smooth",method="lm",size=0.5,alpha=0.5)
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
theme_tufte()+
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ffcccb",size=0.2) +
geom_rangeframe() +
scale_x_continuous(limits =c(19.7,20.2)) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
theme_tufte()+
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.2) +
geom_rangeframe() +
scale_x_continuous(limits =c(19.7,20.2)) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() +
theme_minimal()+
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.2) +
scale_x_continuous(limits =c(19.7,20.2)) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab=("root-to-tip divergence") + xlab("time") +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.2) +
scale_x_continuous(limits =c(19.7,20.2)) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.2) +
scale_x_continuous(limits =c(19.7,20.2)) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.2) +
scale_x_continuous(limits =c(19.75,20.2)) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.2, show.legend = TRUE) +
scale_x_continuous(limits =c(19.75,20.2)) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.2, show.legend = TRUE) +
scale_x_continuous(limits =c(19.75,20.2)) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.2, show.legend = TRUE) +
scale_x_continuous(limits =c(19.75,20.2)) +
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.2, show.legend = TRUE) +
scale_x_continuous(limits =c(19.75,20.2))
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.2, show.legend = TRUE) +
scale_x_continuous(limits =c(19.75,20.2))
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
geom_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.2, show.legend = TRUE) +
scale_x_continuous(limits =c(19.75,20.2)) +
theme(legend.position = "none")
ggplotRegression <- function(fit){
require(ggplot2)
ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) +
geom_point() +
stat_smooth(method = "lm", col = "red") +
labs(title = paste("Adj R2 = ",signif(summary(fit)$adj.r.squared, 5),
"Intercept =",signif(fit$coef[[1]],5 ),
" Slope =",signif(fit$coef[[2]], 5),
" P =",signif(summary(fit)$coef[2,4], 5)))
}
ggplotRegression(lm(distance ~ time, data = df))
ggplotRegression(lm(distance ~ date, data = df))
df %>%
lm(distance~date)
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
stat_smooth(method = "lm", col = "red", alpha=0.5) +
scale_x_continuous(limits =c(19.75,20.2)) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
stat_smooth(method = "lm", col = "red", alpha=0.5, se=FALSE, fullrange=TRUE) +
scale_x_continuous(limits =c(19.75,20.2)) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
stat_smooth(method = "lm", col = "red", alpha=0.5, se=FALSE, fullrange=TRUE) +
scale_x_continuous(limits =c(19.7,20.2)) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
stat_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.2, show.legend = TRUE) +
scale_x_continuous(limits =c(19.7,20.2)) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
stat_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.2, show.legend = TRUE) +
scale_x_continuous(limits =c(19.7,20.2)) +
stat_summary()+
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
stat_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.2, show.legend = TRUE) +
#scale_x_continuous(limits =c(19.7,20.2)) +
stat_summary()+
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
stat_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.2, show.legend = TRUE) +
scale_x_continuous(limits =c(19.7,20.2)) +
stat_summary()+
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
stat_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.2, show.legend = TRUE) +
scale_x_continuous(limits =c(19.7,20.2)) +
theme(legend.position = "none")
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
stat_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.2, show.legend = TRUE) +
scale_x_continuous(limits =c(19.7,20.2)) +
theme(legend.position = "none", panel.border = element_rect(colour = "black", fill=NA, size=1))
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
stat_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.5, show.legend = TRUE) +
scale_x_continuous(limits =c(19.7,20.2)) +
theme(legend.position = "none", panel.border = element_rect(colour = "black", fill=NA, size=1))
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
stat_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.5, show.legend = TRUE) +
scale_x_continuous(limits =c(19.7,20.2)) +
scale_y_continuous(limits =c(0,0.0014)) +
theme(legend.position = "none", panel.border = element_rect(colour = "black", fill=NA, size=1))
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
stat_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.5, show.legend = TRUE) +
scale_x_continuous(limits =c(19.7,20.2)) +
#scale_y_continuous(limits =c(0,0.0014)) +
theme(legend.position = "none", panel.border = element_rect(colour = "black", fill=NA, size=1))
df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
stat_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.5, show.legend = TRUE) +
scale_x_continuous(limits =c(19.7,20.2)) +
scale_y_continuous(limits =c(0,0.0014)) +
theme(legend.position = "none", panel.border = element_rect(colour = "black", fill=NA, size=1))
r2t <- df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
stat_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.5, show.legend = TRUE) +
scale_x_continuous(limits =c(19.7,20.2)) +
scale_y_continuous(limits =c(0,0.0014)) +
theme(legend.position = "none", panel.border = element_rect(colour = "black", fill=NA, size=1))
png("2019-nCov_013120_root_to_tip.png",res=100,width=600,height=900)
print(r2t)
dev.off()
r2t <- df %>%
ggplot(aes(x=date,y=distance,color=location))+
geom_point() + theme_minimal()+
ylab("root-to-tip divergence") + xlab("time") +
stat_smooth(method = "lm", se = FALSE, fullrange=TRUE,alpha=0.5,color="#ff726f",size=0.5, show.legend = TRUE) +
scale_x_continuous(limits =c(19.7,20.2)) +
scale_y_continuous(limits =c(0,0.0013)) +
theme(legend.position = "none", panel.border = element_rect(colour = "black", fill=NA, size=1))
png("2019-nCov_013120_root_to_tip.png",res=100,width=600,height=600)
print(r2t)
dev.off()
library(ggplot2)
library(dplyr)
library(ggtree)
library(treeio)
library(treedater)
library(lubridate)
library(ggthemes)
folder = "../../"
tfile = "tree/2019nCoV_013120_tempest.tre"
tree <- read.tree(paste(folder,tfile,sep=''))
lfile = "2019-nCoV/metaData/date_location_2019nCoV.txt"
tip_location <- read.csv(paste(folder,lfile,sep=''),sep='\t',na.strings = "")
t <- ggtree(tree)# + geom_tiplab(size=3)
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=4) + theme(legend.position="top")
t
png("2019-nCoV_013120_tempest.png",res=100,width=600,height=900)
print(t)
dev.off()
