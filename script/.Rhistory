#dev.off()
t
t <- ggtree(atree, aes(color=group))
t <- t %<+% tip_location + geom_tippoint(aes(color=age_group), size=3)
tip_location <- read.csv(paste(folder,lfile,sep=''),sep='\t',na.strings = "")
t <- t %<+% tip_location + geom_tippoint(aes(color=age_group), size=3)
t
t <- ggtree(atree, aes(color=group))
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=3)
t
t <- ggtree(atree)
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=3)
t
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=3) +
legend()
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=3) +
theme.legend()
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=3)
t
t <- ggtree(atree)
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=3)
t
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=3) + tiplab()
t
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=3) + tip_lab()
t
t <- ggtree(atree) +  + tip_lab()
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=3)
t
t <- ggtree(atree) + tip_lab()
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=3)
t
t <- ggtree(atree) + geom_tiplab()
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=3)
t
t <- ggtree(atree) + geom_tiplab(size=1)
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=4)
t
t <- ggtree(atree) + geom_tiplab(size=3)
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=4)
t
t <- ggtree(atree)# + geom_tiplab(size=3)
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=4)
t
png("annotated_2019nCoV_013020.png",res=100,width=1200,height=1800)
print(t)
dev.off()
t <- ggtree(atree)# + geom_tiplab(size=3)
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=4) + theme(legend.position="right")
t
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=4) + theme(legend.position="top")
t
t <- ggtree(atree)# + geom_tiplab(size=3)
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=4) + theme(legend.position="top")
t
png("annotated_2019nCoV_013020.png",res=100,width=1200,height=1800)
print(t)
dev.off()
library(ggplot2)
library(dplyr)
library(ggtree)
library(treeio)
folder = "/Users/Sung/Dropbox/lab/virus_data/2019nCoV/"
tfile = "tree/annotated_2019nCoV_013020.tre"
tree <- read.tree(paste(folder,tfile,sep=''))
lfile = "metaData/date_location_2019nCoV.txt"
tip_location <- read.csv(paste(folder,lfile,sep=''),sep='\t',na.strings = "")
t <- ggtree(atree)# + geom_tiplab(size=3)
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=4) + theme(legend.position="top")
t
png("annotated_2019nCoV_013020.png",res=100,width=600,height=900)
print(t)
dev.off()
tree <- read.tree(paste(folder,tfile,sep=''))
lfile = "metaData/date_location_2019nCoV.txt"
tip_location <- read.csv(paste(folder,lfile,sep=''),sep='\t',na.strings = "")
t <- ggtree(tree)# + geom_tiplab(size=3)
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=4) + theme(legend.position="top")
t
png("annotated_2019nCoV_013020.png",res=100,width=600,height=900)
print(t)
dev.off()
bfile = "2019nCov_013020_hkyr4_cons.tre"
btree <- read.beast(paste(folder,bfile,sep=''))
b <- ggtree(btree)
library(ggplot2)
library(dplyr)
library(ggtree)
library(treeio)
# Maximum likelihood phylogenetic tree visualization with ggtree
folder = "/Users/Sung/Dropbox/lab/virus_data/2019nCoV/"
tfile = "tree/annotated_2019nCoV_013020.tre"
tree <- read.tree(paste(folder,tfile,sep=''))
lfile = "metaData/date_location_2019nCoV.txt"
tip_location <- read.csv(paste(folder,lfile,sep=''),sep='\t',na.strings = "")
t <- ggtree(tree)# + geom_tiplab(size=3)
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=4) + theme(legend.position="top")
bfile = "2019nCov_013020_hkyr4_cons.tre"
btree <- read.beast(paste(folder,bfile,sep=''))
bfile = "tMRCA/2019nCov_013020_hkyr4_cons.tre"
btree <- read.beast(paste(folder,bfile,sep=''))
b <- ggtree(btree)
b <- b %<+% tip_location + geom_tippoint(aes(color=Location), size=4) + theme(legend.position="top")
b
bfile = "tMRCA/2019nCov_013020_hkyr4_cons.tre"
btree <- read.beast(paste(folder,bfile,sep=''))
b <- ggtree(btree)
b <- b %<+% tip_location + geom_tippoint(aes(color=Location), size=4) + theme(legend.position="top")
b
png("2019nCov_013020_hkyr4_cons.png",res=100,width=600,height=900)
print(b)
dev.off()
library(ggplot2)
library(dplyr)
library(ggtree)
library(treeio)
# Maximum likelihood phylogenetic tree visualization with ggtree
folder = "../../"
tfile = "tree/annotated_2019nCoV_013120.tre"
tree <- read.tree(paste(folder,tfile,sep=''))
lfile = "../metaData/date_location_2019nCoV.txt"
tip_location <- read.csv(paste(folder,lfile,sep=''),sep='\t',na.strings = "")
t <- ggtree(tree)# + geom_tiplab(size=3)
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=4) + theme(legend.position="top")
t
png("2019-nCoV_013120.png",res=100,width=600,height=900)
print(t)
dev.off()
folder = "../../"
tfile = "tree/annotated_2019nCoV_013120.tre"
tree <- read.tree(paste(folder,tfile,sep=''))
lfile = "2019-nCoV/metaData/date_location_2019nCoV.txt"
tip_location <- read.csv(paste(folder,lfile,sep=''),sep='\t',na.strings = "")
folder = "../../"
tfile = "tree/2019nCoV_013120.tre"
tree <- read.tree(paste(folder,tfile,sep=''))
lfile = "2019-nCoV/metaData/date_location_2019nCoV.txt"
tip_location <- read.csv(paste(folder,lfile,sep=''),sep='\t',na.strings = "")
t <- ggtree(tree)# + geom_tiplab(size=3)
t <- t %<+% tip_location + geom_tippoint(aes(color=Location), size=4) + theme(legend.position="top")
t
png("2019-nCoV_013120.png",res=100,width=600,height=900)
print(t)
dev.off()
bfile = "beast/2019nCov_013120_hkyr4_cons.tre"
btree <- read.beast(paste(folder,bfile,sep=''))
b <- ggtree(btree)
b <- b %<+% tip_location + geom_tippoint(aes(color=Location), size=4) + theme(legend.position="top")
b
png("2019-nCov_013120_hkyr4_cons.png",res=100,width=600,height=900)
print(b)
dev.off()
library(ggplot2)
library(dplyr)
library(ggtree)
library(treeio)
library(treedater)
folder = "../../"
tfile = "tree/2019nCoV_013120.tre"
tre <- read.tree(paste(folder,tfile,sep=''))
td <- dater(tre, sts, s=29910, clock='strict')
dfile = "2019-nCoV/metaData/date_location_2019nCoV.txt"
sts <- read.csv(paste(folder,lfile,sep=''),sep='\t',na.strings = "")
sts <- read.csv(paste(folder,dfile,sep=''),sep='\t',na.strings = "")
td <- dater(tre, sts, s=29910, clock='strict')
date <- read.csv(paste(folder,dfile,sep=''),sep='\t',na.strings = "")
sts <- c(date["Name"],date["date"])
td <- dater(tre, sts, s=29910, clock='strict')
tre <- ape::rtree(25)
# sample times based on distance from root to tip:
sts <- setNames( ape::node.depth.edgelength( tre )[1:ape::Ntip(tre)], tre$tip.label)
sts
sts <- setNames(date["Name"],date["date"])
View(sts)
date["date"]
# sample times based on distance from root to tip:
sts <- setNames( ape::node.depth.edgelength( tre )[1:ape::Ntip(tre)], tre$tip.label)
sts <- date["date"]
View(sts)
sts <- c(date["date"])
View(sts)
sts[["date"]]
names(sts) <- c(data["Name"])
names(sts) <- c(date["Name"])
View(sts)
sts[["c(24, 25, 26, 2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 27, 17, 18, 19, 20, 21, 22, 23, 28, 35, 36, 37, 31, 42, 29, 41, 43, 44, 45, 30, 48, 34, 33, 32, 38, 40, 39, 46, 47, 7, 1)"]]
td <- dater(tre, sts, s=29910, clock='strict')
View(tre)
tre[["tip.label"]]
tre[["edge"]]
View(sts)
sts[["c(24, 25, 26, 2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 27, 17, 18, 19, 20, 21, 22, 23, 28, 35, 36, 37, 31, 42, 29, 41, 43, 44, 45, 30, 48, 34, 33, 32, 38, 40, 39, 46, 47, 7, 1)"]]
# sample times based on distance from root to tip:
sts <- setNames( ape::node.depth.edgelength( tre )[1:ape::Ntip(tre)], tre$tip.label)
sts
list(date["Name"])
# sample times based on distance from root to tip:
sts <- setNames( ape::node.depth.edgelength( tre )[1:ape::Ntip(tre)], tre$tip.label)
sts
install.packages('lubridate')
library(lubridate)
decimal_date(date["Name"])
folder = "../../"
tfile = "tree/2019nCoV_013120.tre"
tre <- read.tree(paste(folder,tfile,sep=''))
View(tre)
date <-
sts <- c(date["date"])
names(sts) <- c(date["Name"])
td <- dater(tre, sts, s=29910, clock='strict')
date <- unlist(date["date"])
date <- decimal_date(unlist(date["date"]) )
sts <- unlist(date["date"])
names(sts) <- unlist(date["Name"])
td <- dater(tre, sts, s=29910, clock='strict')
sts
date <- unlist(date["date"])
name <- unlist(date["Name"])
date
date <- c(unlist(date["date"]))
name <- c(unlist(date["Name"]))
date
date <- unlist(date["date"])
name <- unlist(date["Name"])
date[1]
date[2]
date
dfile = "2019-nCoV/metaData/date_location_2019nCoV.txt"
date_df <- read.csv(paste(folder,dfile,sep=''),sep='\t',na.strings = "")
date <- c(unlist(date_df["date"]))
date
date <- unlist(date_df["date"])
date
name <- unlist(date_df["Name"])
sts <- date
names(sts) <- name
sts
td <- dater(tre, sts, s=29910, clock='strict')
sts
dfile = "2019-nCoV/metaData/date_location_2019nCoV.txt"
date_df <- read.csv(paste(folder,dfile,sep=''),sep='\t',na.strings = "")
date_d <- data.frame(Index=date_df['Date'])
date_d <- data.frame(Index=date_df['Name'])
date <- c(unlist(date_d["date"]))
View(date_d)
date_df <- read.csv(paste(folder,dfile,sep=''),sep='\t',na.strings = "")
rowsname(date_df) <- df$Name
rowsname(date_df) <- date_df$Name
dfile = "2019-nCoV/metaData/date_location_2019nCoV.txt"
date_df <- read.csv(paste(folder,dfile,sep=''),sep='\t',na.strings = "")
rownames(date_df) <- date_df$Name
date <- c(unlist(date_d["date"]))
date <- c(unlist(date_df["date"]))
date
date_df["date"]
c(date_df["date"])
unlist(date_df["date"])
date[i]
date[1]
date[1]
date <- date_df["date"])
date[1]
date <- date_df["date"]
date[1]
date_df <- read.csv(paste(folder,dfile,sep=''),sep='\t',na.strings = "")
date <- date_df["date"]
date[1]
date[1]
date[:1]
date[[1]]
date <- c(date_df["date"])
date[[1]]
date <- c(date_df[["date"]])
date[[1]]
date
dfile = "2019-nCoV/metaData/date_location_2019nCoV.txt"
date_df <- read.csv(paste(folder,dfile,sep=''),sep='\t',na.strings = "")
rownames(date_df) <- date_df$Name
date <- c(date_df[["date"]])
date
date <- c(str(date_df[["date"]]))
date
date <- c(date_df[["date"])
dfile = "2019-nCoV/metaData/date_location_2019nCoV.txt"
date_df <- read.csv(paste(folder,dfile,sep=''),sep='\t',na.strings = "")
date <- c(date_df[["Name"]])
date
date <- c(date_df["Name"])
date
avector <- as.vector(date_df["Name"])
class(avector)
avector <- aframe[[date_df["Name"]]]
avector <- as.vector(date_df["Name"])
class(avector)
avector <- date_df[['Name']]
class(avector)
avector <- date_df[,1]
class(avector)
avector <- date_df[['Name']]
class(avector)
avector
avector <- date_df[,1]
class(avector)
avector
name <- date_df[,1]
date <- date_df[,2]
sts <- date
names(sts) <- name
sts
td <- dater(tre, sts, s=29910, clock='strict')
library(ggplot2)
library(dplyr)
library(ggtree)
library(treeio)
library(treedater)
library(lubridate)
folder = "../../"
tfile = "tree/2019nCoV_013120.tre"
tre <- read.tree(paste(folder,tfile,sep=''))
td <- dater(tre, sts, s=29910, clock='strict')
name <- date_df[,"Name"]
name
sam <- ape::rtree(25)
# sample times based on distance from root to tip:
sts <- setNames( ape::node.depth.edgelength( sam )[1:ape::Ntip(sam)], sam$tip.label)
sts
sts <- setNames(date, name)
sts
td <- dater(tre, sts, s=29910, clock='strict')
date[1]
length(date)
ndate = c()
for (i in 1:length(date)){
numdate <- decimal_date(date[i])
answer <- append(ndate, numdate)
}
date[1]
decimlar_date("1/12/20")
decimal_date("1/12/20")
decimal_date("01/12/20")
decimal_date("01/12/2020")
mdy("01/12/2020")
mdy("01/12/20")
mdy("1/12/20")
for (i in 1:length(date)){
d <- mdy(date[i])
numdate <- decimal_date(date[i])
answer <- append(ndate, numdate)
}
for (i in 1:length(date)){
d <- mdy(date[i])
numdate <- decimal_date(d)
answer <- append(ndate, numdate)
}
ndate = c()
ndate = c()
for (i in 1:length(date)){
d <- mdy(date[i])
numdate <- decimal_date(d)
answer <- append(ndate, numdate)
}
ndate = c()
for (i in 1:length(date)){
d <- mdy(date[i])
numdate <- decimal_date(d)
ndate <- append(ndate, numdate)
}
ndate
sts <- setNames(date,name)
sts
sts <- setNames(ndate,name)
sts
td <- dater(tre, sts, s=29910, clock='strict')
fit = rootToTipRegressionPlot( td )
summary(fit)
folder = "../../"
tfile = "tree/2019nCoV_013120.tre"
tre <- read.tree(paste(folder,tfile,sep=''))
dfile = "2019-nCoV/metaData/date_location_2019nCoV.txt"
date_df <- read.csv(paste(folder,dfile,sep=''),sep='\t',na.strings = "")
name <- date_df[,"Name"]
date <- date_df[,"date"]
ndate = c()
for (i in 1:length(date)){
d <- mdy(date[i])
numdate <- decimal_date(d)
ndate <- append(ndate, numdate)
}
sts <- setNames(ndate,name)
td <- dater(tre, sts, s=29910, clock='strict')
fit = rootToTipRegressionPlot( td )
td <- dater(tre, sts, s=29910, clock='strict')
fit = rootToTipRegressionPlot( td )
summary(fit)
td <- dater(tre, sts, clock='strict')
fit = rootToTipRegressionPlot( td )
summary(fit)
library(ggplot2)
library(dplyr)
library(ggtree)
library(treeio)
library(treedater)
library(lubridate)
folder = "../../"
tfile = "tree/2019nCoV_013120.tre"
tre <- read.tree(paste(folder,tfile,sep=''))
dfile = "2019-nCoV/metaData/date_location_2019nCoV.txt"
date_df <- read.csv(paste(folder,dfile,sep=''),sep='\t',na.strings = "")
name <- date_df[,"Name"]
date <- date_df[,"date"]
ndate = c()
for (i in 1:length(date)){
d <- mdy(date[i])
numdate <- decimal_date(d)
ndate <- append(ndate, numdate)
}
sts <- setNames(ndate,name)
td <- dater(tre, sts, clock='strict')
fit = rootToTipRegressionPlot( td )
summary(fit)
fit = rootToTipRegressionPlot( td )
fit
sts <- setNames(ndate,name)
td <- dater(tre, sts, clock='strict')
fit = rootToTipRegressionPlot( td )
fit
summary(fit)
td <- dater(tre, sts, s=29910, clock='strict', omega0=0.00135)
td <- dater(tre, sts=sts, s=29910, clock='strict', omega0=0.00135)
td <- dater(tre, sts=sts, s=29910, clock='strict', omega0 = .00135)
td <- dater(tre, sts=sts, s=29910, clock='strict', omega0 = .00135, numStartConditions = 0)
fit = rootToTipRegressionPlot(td)
summary(fit)
folder = "../../"
folder = "../../"
tfile = "tree/2019nCoV_013120_tempest.tre"
tre <- read.tree(paste(folder,tfile,sep=''))
tre <- read.beast(paste(folder,tfile,sep=''))
tre <- read.tree(paste(folder,tfile,sep=''))
View(tre)
folder = "../../"
tfile = "tree/2019nCoV_013120.tre"
tre <- read.tree(paste(folder,tfile,sep=''))
dfile = "2019-nCoV/metaData/date_location_2019nCoV.txt"
date_df <- read.csv(paste(folder,dfile,sep=''),sep='\t',na.strings = "")
name <- date_df[,"Name"]
date <- date_df[,"date"]
ndate = c()
for (i in 1:length(date)){
d <- mdy(date[i])
numdate <- decimal_date(d)
ndate <- append(ndate, numdate)
}
sts <- setNames(ndate,name)
td <- dater(tre, searhRoot=5, sts=sts, s=29910, clock='strict', omega0 = .00135, numStartConditions = 0)
td <- dater(tre, searchRoot=5, sts=sts, s=29910, clock='strict')
fit = rootToTipRegressionPlot(td)
fit
summary(fit)
td <- dater(tre, searchRoot=5, sts=sts, s=29910, clock='strict')
sts
td <- dater(tre, searchRoot=5, sts=sts, s=29910, clock='strict')
tfile = "tree/2019nCoV_013120_tempest.tre"
tre <- read.tree(paste(folder,tfile,sep=''))
dfile = "2019-nCoV/metaData/date_location_2019nCoV.txt"
date_df <- read.csv(paste(folder,dfile,sep=''),sep='\t',na.strings = "")
name <- date_df[,"Name"]
date <- date_df[,"date"]
ndate = c()
for (i in 1:length(date)){
d <- mdy(date[i])
numdate <- decimal_date(d)
ndate <- append(ndate, numdate)
}
sts
sts <- setNames(ndate,name)
td <- dater(tre, sts=sts, s=29910, clock='strict')
fit = rootToTipRegressionPlot(td)
fit
fit = rootToTipRegressionPlot(td)
summary(fit)
td <- dater(tre, sts=sts, s=29910, clock='strict')
sts
sts <- setNames(ndate,name)
td <- dater(tre, sts=sts, s=29910, clock='strict')
fit = rootToTipRegressionPlot(td)
goodnessOfFitPlot(td)
outlierLineages(td, alpha = 0.05, type = c("tips", "internal", "all"))
outlierTips(td, alpha = 0.05)
tfile = "tree/2019nCoV_013120.tre"
tre <- read.tree(paste(folder,tfile,sep=''))
dfile = "2019-nCoV/metaData/date_location_2019nCoV.txt"
date_df <- read.csv(paste(folder,dfile,sep=''),sep='\t',na.strings = "")
name <- date_df[,"Name"]
date <- date_df[,"date"]
ndate = c()
for (i in 1:length(date)){
d <- mdy(date[i])
numdate <- decimal_date(d)
ndate <- append(ndate, numdate)
}
sts
sts <- setNames(ndate,name)
td <- dater(tre, sts=sts, s=29910, clock='strict')
outlierTips(td, alpha = 0.05)
td <- dater(tre, sts=sts, abstol = 1e-04, searchRoot = 100, s=29910, clock='strict', numStartConditions = 1)
td <- dater(tre, sts=sts, abstol = 1e-04, searchRoot = 100, s=29910, clock='strict', numStartConditions = 1)
outlierTips(td, alpha = 0.05)
fit = rootToTipRegressionPlot(td,  show.tip.labels = TRUE)
td <- dater(tre, sts=sts, abstol = 1e-04, searchRoot = 100, s=29910, clock='strict', numStartConditions = 1)
fit = rootToTipRegressionPlot(td)
summary(fit)
